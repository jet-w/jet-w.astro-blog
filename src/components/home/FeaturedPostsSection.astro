---
/**
 * 首页特色文章组件
 */
import PostCard from '../../components/blog/PostCard.astro';
import { getCollection } from 'astro:content';

export interface Props {
  count?: number;
}

const { count = 3 } = Astro.props;

const allPosts = await getCollection('posts');
const publishedPosts = allPosts
  .filter(post => !post.data.draft)
  .sort((a, b) => (b.data.pubDate?.getTime() ?? 0) - (a.data.pubDate?.getTime() ?? 0));

const featuredPosts = publishedPosts.slice(0, count).map(post => ({
  slug: post.id.toLowerCase(),
  title: post.data.title,
  description: post.data.description,
  pubDate: post.data.pubDate,
  tags: post.data.tags,
  categories: post.data.categories,
  author: post.data.author,
  readingTime: 5
}));
---

{featuredPosts.length > 0 && (
  <section class="mb-16">
    <div class="flex items-center justify-between mb-8">
      <h2 class="text-2xl font-bold text-slate-900 dark:text-slate-100">
        特色文章
      </h2>
      <a
        href="/posts"
        class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 font-medium text-sm flex items-center space-x-1 transition-colors"
      >
        <span>查看全部</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {featuredPosts.map((post) => (
        <PostCard post={post} featured={true} />
      ))}
    </div>
  </section>
)}
