---
/**
 * é€šç”¨å›¾æ ‡ç»„ä»¶
 * æ”¯æŒå¤šç§å›¾æ ‡æ ¼å¼ï¼š
 *
 * 1. Emoji: ç›´æ¥ä½¿ç”¨ emoji å­—ç¬¦ï¼Œå¦‚ "ğŸ“" "ğŸ‰"
 *
 * 2. Font Awesome:
 *    - "fa:folder" â†’ <i class="fa-solid fa-folder"></i>
 *    - "fa-brands:github" â†’ <i class="fa-brands fa-github"></i>
 *    - "fa-regular:star" â†’ <i class="fa-regular fa-star"></i>
 *
 * 3. Material Icons:
 *    - "mi:folder" â†’ <span class="material-icons">folder</span>
 *    - "mi-outlined:folder" â†’ <span class="material-icons-outlined">folder</span>
 *    - "mi-round:folder" â†’ <span class="material-icons-round">folder</span>
 *
 * 4. Bootstrap Icons:
 *    - "bi:folder" â†’ <i class="bi bi-folder"></i>
 *
 * 5. Remix Icon:
 *    - "ri:folder-line" â†’ <i class="ri-folder-line"></i>
 *    - "ri:folder-fill" â†’ <i class="ri-folder-fill"></i>
 *
 * 6. Ionicons:
 *    - "ion:folder" â†’ <ion-icon name="folder"></ion-icon>
 *    - "ion:folder-outline" â†’ <ion-icon name="folder-outline"></ion-icon>
 */

export interface Props {
  icon: string;
  class?: string;
  size?: string;
}

const { icon, class: className = '', size = '1em' } = Astro.props;

// è§£æå›¾æ ‡æ ¼å¼
function parseIcon(iconStr: string) {
  if (!iconStr) return { type: 'none', value: '' };

  // æ£€æµ‹æ˜¯å¦æœ‰å‰ç¼€
  const hasPrefix = /^[a-z-]+:/i.test(iconStr);

  if (!hasPrefix) {
    // æ£€æµ‹æ˜¯å¦ä¸º emojiï¼ˆåŒ…å«é ASCII å­—ç¬¦ï¼‰
    const isEmoji = /[\u{1F300}-\u{1F9FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]|[\u{1F600}-\u{1F64F}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]/u.test(iconStr);
    if (isEmoji) {
      return { type: 'emoji', value: iconStr };
    }

    // æ²¡æœ‰å‰ç¼€ä¸”ä¸æ˜¯ emojiï¼Œé»˜è®¤å½“ä½œ Font Awesome solid å›¾æ ‡
    return { type: 'fa', style: 'solid', value: iconStr };
  }

  const [prefix, ...rest] = iconStr.split(':');
  const value = rest.join(':');

  switch (prefix.toLowerCase()) {
    // Font Awesome
    case 'fa':
      return { type: 'fa', style: 'solid', value };
    case 'fa-solid':
    case 'fas':
      return { type: 'fa', style: 'solid', value };
    case 'fa-regular':
    case 'far':
      return { type: 'fa', style: 'regular', value };
    case 'fa-brands':
    case 'fab':
      return { type: 'fa', style: 'brands', value };
    case 'fa-light':
    case 'fal':
      return { type: 'fa', style: 'light', value };
    case 'fa-thin':
    case 'fat':
      return { type: 'fa', style: 'thin', value };
    case 'fa-duotone':
    case 'fad':
      return { type: 'fa', style: 'duotone', value };

    // Material Icons
    case 'mi':
    case 'material':
      return { type: 'material', style: 'filled', value };
    case 'mi-outlined':
    case 'material-outlined':
      return { type: 'material', style: 'outlined', value };
    case 'mi-round':
    case 'material-round':
      return { type: 'material', style: 'round', value };

    // Bootstrap Icons
    case 'bi':
    case 'bootstrap':
      return { type: 'bootstrap', value };

    // Remix Icon
    case 'ri':
    case 'remix':
      return { type: 'remix', value };

    // Ionicons
    case 'ion':
    case 'ionicon':
      return { type: 'ionicon', value };

    default:
      // æœªçŸ¥å‰ç¼€ï¼Œå½“ä½œ emoji å¤„ç†
      return { type: 'emoji', value: iconStr };
  }
}

const parsed = parseIcon(icon);
---

{parsed.type === 'emoji' && (
  <span class:list={['icon-emoji', className]} style={`font-size: ${size};`}>{parsed.value}</span>
)}

{parsed.type === 'fa' && (
  <i
    class:list={[`fa-${parsed.style}`, `fa-${parsed.value}`, className]}
    style={`font-size: ${size};`}
  ></i>
)}

{parsed.type === 'material' && parsed.style === 'filled' && (
  <span
    class:list={['material-icons', className]}
    style={`font-size: ${size};`}
  >{parsed.value}</span>
)}

{parsed.type === 'material' && parsed.style === 'outlined' && (
  <span
    class:list={['material-icons-outlined', className]}
    style={`font-size: ${size};`}
  >{parsed.value}</span>
)}

{parsed.type === 'material' && parsed.style === 'round' && (
  <span
    class:list={['material-icons-round', className]}
    style={`font-size: ${size};`}
  >{parsed.value}</span>
)}

{parsed.type === 'bootstrap' && (
  <i
    class:list={['bi', `bi-${parsed.value}`, className]}
    style={`font-size: ${size};`}
  ></i>
)}

{parsed.type === 'remix' && (
  <i
    class:list={[`ri-${parsed.value}`, className]}
    style={`font-size: ${size};`}
  ></i>
)}

{parsed.type === 'ionicon' && (
  <ion-icon
    name={parsed.value}
    class={className}
    style={`font-size: ${size};`}
  ></ion-icon>
)}

<style>
  .icon-emoji {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
  }

  /* ç»Ÿä¸€å›¾æ ‡å‚ç›´å¯¹é½ */
  i, span.material-icons, span.material-icons-outlined, span.material-icons-round, ion-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    vertical-align: middle;
    line-height: 1;
  }
</style>
